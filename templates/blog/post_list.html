{% extends 'blog/base.html' %}

{% block title %}–ë–ª–æ–≥ –ø—Ä–æ –º–∞—à–∏–Ω—ã - –ì–ª–∞–≤–Ω–∞—è{% endblock %}

{% block content %}
<h1 style="text-align: center; margin-bottom: 2rem; color: #667eea;">–ë–ª–æ–≥ –ø—Ä–æ –º–∞—à–∏–Ω—ã</h1>

{% if categories %}
<div class="categories">
    <a href="{% url 'blog:post_list' %}" class="category-link {% if not selected_category %}active{% endif %}">–í—Å–µ</a>
    {% for category in categories %}
    <a href="{% url 'blog:category_detail' category.slug %}" class="category-link {% if selected_category == category.slug %}active{% endif %}">
        {{ category.name }}
    </a>
    {% endfor %}
</div>
{% endif %}

{% if search_query %}
<div style="margin-bottom: 1rem; padding: 1rem; background: #e3f2fd; border-radius: 5px;">
    <strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É:</strong> "{{ search_query }}"
</div>
{% endif %}

{% if page_obj %}
<div class="posts-grid">
    {% for post in page_obj %}
    <article class="post-card">
        {% if post.image %}
        <img src="{{ post.image.url }}" alt="{{ post.title }}" class="post-image">
        {% else %}
        <div class="post-image"></div>
        {% endif %}
        <div class="post-content">
            <h2 class="post-title">
                <a href="{% url 'blog:post_detail' post.slug %}">{{ post.title }}</a>
            </h2>
            <div class="post-meta">
                <span>üìÖ {{ post.created_at|date:"d.m.Y" }}</span>
                {% if post.category %}
                <span> | üìÇ {{ post.category.name }}</span>
                {% endif %}
                <span> | üëÅÔ∏è {{ post.views }}</span>
            </div>
            {% if post.excerpt %}
            <p class="post-excerpt">{{ post.excerpt|truncatewords:20 }}</p>
            {% endif %}
            <a href="{% url 'blog:post_detail' post.slug %}" class="read-more">–ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ ‚Üí</a>
        </div>
    </article>
    {% endfor %}
</div>

{% if page_obj.has_other_pages %}
<div class="pagination">
    {% if page_obj.has_previous %}
    <a href="?page=1{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}">¬´ –ü–µ—Ä–≤–∞—è</a>
    <a href="?page={{ page_obj.previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}">‚Äπ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
    {% endif %}
    
    <span class="current">
        –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page_obj.number }} –∏–∑ {{ page_obj.paginator.num_pages }}
    </span>
    
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}">–°–ª–µ–¥—É—é—â–∞—è ‚Ä∫</a>
    <a href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&search={{ search_query }}{% endif %}{% if selected_category %}&category={{ selected_category }}{% endif %}">–ü–æ—Å–ª–µ–¥–Ω—è—è ¬ª</a>
    {% endif %}
</div>
{% endif %}

{% else %}
<div style="text-align: center; padding: 3rem;">
    <h2>–ü–æ—Å—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h2>
    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã.</p>
</div>
{% endif %}
{% endblock %}

